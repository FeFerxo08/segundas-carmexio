<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script src="https://www.paypal.com/sdk/js?client-id=Ae2_m12iAWxbaV38QI2_-m6t1a1pQAgImsqw7GVaM7NHyJHs1rMpWTmL2yskHUaFA8h__MppibN4btd6&currency=MXN"></script>
    
</head>


<body>
    <div id="paypal-button-container"></div>

    <script>
        paypal.Buttons({

            style: {
                color: 'blue',
                shape: 'pill',
                label: 'pay'
            },

            createOrder: function(data, actions) {
                return actions.order.create({
                    purchase_units: [{
                        amount: {
                            value: 11733.05                        },
                        description: 'Compra tienda CDP'
                    }],
                    application_context: {
				shipping_preference: "NO_SHIPPING",
				brand_name: "Códigos de Programación",
			}
                });
            },

            onApprove: function(data, actions) {

                let url = 'clases/captura.php';
                actions.order.capture().then(function(details) {

                    console.log(details);

                    let trans = details.purchase_units[0].payments.captures[0].id;
                    return fetch(url, {
                        method: 'post',
                        mode: 'cors',
                        headers: {
                            'content-type': 'application/json'
                        },
                        body: JSON.stringify({
                            details: details
                        })
                    }).then(function(response) {
                        window.location.href = "completado.php?key=" + trans;
                    });
                });
            },

            onCancel: function(data) {
                console.log("Cancelo :(");
                console.log(data);
            }
        }).render('#paypal-button-container');


        const mp = new MercadoPago('TEST-f8d3d553-b99f-4684-8044-5fa273e6162b', {
            locale: 'es-MX'
        });

        // Inicializa el checkout Mercado Pago
        mp.checkout({
            preference: {
                id: '237609137-a1e7c574-39f5-4b07-ad6c-fecff48fc2a4'
            },
            render: {
                container: '.checkout-btn', // Indica el nombre de la clase donde se mostrará el botón de pago
                type: 'wallet', // Muestra un botón de pago con la marca Mercado Pago
                label: 'Pagar con Mercado Pago', // Cambia el texto del botón de pago (opcional)
            }
        });
    </script>
</body>
</html>